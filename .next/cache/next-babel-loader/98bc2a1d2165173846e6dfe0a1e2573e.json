{"ast":null,"code":"var _jsxFileName = \"/Users/daehankim/Documents/GitHub/blogshot/pages/post.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { makeStyles } from \"@material-ui/styles\";\nimport Layout from \"../components/layouts/Layout\";\nimport ActionMyBar from \"../components/component/ActionMyBar\";\nimport { useRouter } from \"next/router\";\nimport { TextField, FormControl, Card, Button, CircularProgress, InputLabel, Select, MenuItem } from \"@material-ui/core\";\nimport useDataOne from \"../useActions/useDataOne\";\nimport usePost from \"../useActions/usePost\";\nimport { useState, useEffect } from \"react\";\nconst useStyles = makeStyles(theme => ({\n  root: {},\n  content: {\n    padding: \"64px 0px 0px\"\n  },\n  card: {\n    backgroundColor: \"rgb(240 240 240)\",\n    padding: \"20px\",\n    margin: \"0px 20px 20px\"\n  },\n  textField: {\n    margin: \"10px 10px 20px\"\n  },\n  actions: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    padding: \"0px 20px 5px\",\n    marginTop: \"15px\"\n  },\n  button: {\n    margin: \"5px\"\n  },\n  process: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  formControl: {\n    display: \"flex\",\n    flexDirection: \"row\"\n  },\n  select: {\n    marginLeft: \"10px\"\n  }\n}));\n\nconst Index = props => {\n  const classes = useStyles();\n  const route = useRouter();\n  const {\n    data: post,\n    loading,\n    error\n  } = useDataOne(\"posts\", route.query.code);\n  const {\n    0: updatePost,\n    1: setUpdatePost\n  } = useState(post);\n  const {\n    postSave,\n    postDelete,\n    posting\n  } = usePost();\n  const {\n    0: categoryData,\n    1: setCategoryData\n  } = useState([]);\n  const {\n    0: selected,\n    1: setSelected\n  } = useState();\n  useEffect(() => {\n    let category = localStorage.getItem(\"category\");\n    let category_sel = localStorage.getItem(\"category_sel\");\n\n    if (category) {\n      category = JSON.parse(category);\n      setCategoryData(category);\n    }\n\n    if (category_sel) {\n      category_sel = JSON.parse(category_sel);\n      setSelected(category_sel);\n    }\n  }, []);\n  useEffect(() => {\n    setUpdatePost(post);\n  }, [post]);\n\n  const handleOnSave = () => {\n    postSave(post.code, {\n      title: updatePost.title,\n      context: updatePost.context\n    }, {\n      success: res => {\n        if (res.data && res.data.msg) {\n          alert(res.data.msg);\n        }\n      },\n      fail: err => {\n        if (err.response.data && err.response.data.msg) {\n          alert(err.response.data.msg);\n        }\n      }\n    });\n  };\n\n  const handleOnDelete = () => {\n    if (window.confirm(\"정말 이 포스트를 삭제하시겠습니까?\")) postDelete(post.code, {\n      success: res => {\n        if (res.data && res.data.msg) {\n          alert(res.data.msg);\n          route.back();\n        }\n      },\n      fail: err => {\n        if (err.response.data && err.response.data.msg) {\n          alert(err.response.data.msg);\n        }\n      }\n    });\n  };\n\n  const handleOnPosting = () => {\n    posting(updatePost, {\n      success: sres => {\n        if (sres.data && sres.data.msg) {\n          alert(sres.data.msg);\n          route.back();\n        }\n      },\n      fail: err => {\n        if (err.response && err.response.data) alert(err.response.data.msg);\n        console.log(err);\n      }\n    });\n  };\n\n  const handleUpdataPost = key => e => {\n    setUpdatePost(_objectSpread({}, updatePost, {\n      [key]: e.target.value\n    }));\n  };\n\n  const handleChange = e => setSelected(e.target.value);\n\n  const handleKeyDown = e => {\n    if (e.key === \"Enter\") {\n      console.log(e.target.value);\n      const datas = [...categoryData, e.target.value];\n      localStorage.setItem(\"category\", JSON.stringify(datas));\n      setCategoryData(datas);\n    }\n  };\n\n  const MyPage = __jsx(\"div\", {\n    className: classes.root,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, __jsx(ActionMyBar, {\n    homeEnable: false,\n    title: post.code || \"포스트\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: classes.content,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: classes.actions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, __jsx(FormControl, {\n    variant: \"filled\",\n    classes: {\n      root: classes.formControl\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, __jsx(TextField, {\n    label: \"\\uCE74\\uD14C\\uACE0\\uB9AC\",\n    onKeyDown: handleKeyDown,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }), __jsx(Select, {\n    className: classes.select,\n    labelId: \"demo-simple-select-filled-label\",\n    id: \"demo-simple-select-filled\",\n    value: selected,\n    defaultValue: selected,\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, categoryData.map((item, index) => {\n    return __jsx(MenuItem, {\n      key: item + \"-\" + index,\n      value: item,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, item);\n  }))), __jsx(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, __jsx(Button, {\n    className: classes.button,\n    variant: \"contained\",\n    color: \"secondary\",\n    disabled: loading,\n    onClick: handleOnDelete,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, \"\\uC0AD\\uC81C\"), __jsx(Button, {\n    className: classes.button,\n    variant: \"contained\",\n    color: \"primary\",\n    disabled: loading,\n    onClick: handleOnSave,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, \"\\uC800\\uC7A5\"), __jsx(Button, {\n    className: classes.button,\n    variant: \"contained\",\n    color: \"default\",\n    disabled: loading,\n    onClick: handleOnPosting,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, \"\\uD3EC\\uC2A4\\uD305\"))), __jsx(Card, {\n    className: classes.card,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, loading ? __jsx(\"div\", {\n    className: classes.process,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, __jsx(CircularProgress, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  })) : __jsx(FormControl, {\n    fullWidth: true,\n    variant: \"outlined\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210\n    },\n    __self: this\n  }, __jsx(TextField, {\n    className: classes.textField,\n    multiline: true,\n    fullWidth: true,\n    label: \"제목\",\n    onChange: handleUpdataPost(\"title\"),\n    defaultValue: post.title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }), __jsx(TextField, {\n    className: classes.textField,\n    multiline: true,\n    fullWidth: true,\n    label: \"내용\",\n    onChange: handleUpdataPost(\"context\"),\n    defaultValue: post.context,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }))), error && __jsx(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }, error)));\n\n  return __jsx(Layout, {\n    cookies: props.cookies,\n    content: MyPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  });\n};\n\nexport default Index;","map":{"version":3,"sources":["/Users/daehankim/Documents/GitHub/blogshot/pages/post.js"],"names":["makeStyles","Layout","ActionMyBar","useRouter","TextField","FormControl","Card","Button","CircularProgress","InputLabel","Select","MenuItem","useDataOne","usePost","useState","useEffect","useStyles","theme","root","content","padding","card","backgroundColor","margin","textField","actions","display","alignItems","justifyContent","marginTop","button","process","formControl","flexDirection","select","marginLeft","Index","props","classes","route","data","post","loading","error","query","code","updatePost","setUpdatePost","postSave","postDelete","posting","categoryData","setCategoryData","selected","setSelected","category","localStorage","getItem","category_sel","JSON","parse","handleOnSave","title","context","success","res","msg","alert","fail","err","response","handleOnDelete","window","confirm","back","handleOnPosting","sres","console","log","handleUpdataPost","key","e","target","value","handleChange","handleKeyDown","datas","setItem","stringify","MyPage","map","item","index","cookies"],"mappings":"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","sourcesContent":["import { makeStyles } from \"@material-ui/styles\";\n\nimport Layout from \"../components/layouts/Layout\";\n\nimport ActionMyBar from \"../components/component/ActionMyBar\";\n\nimport { useRouter } from \"next/router\";\nimport {\n  TextField,\n  FormControl,\n  Card,\n  Button,\n  CircularProgress,\n  InputLabel,\n  Select,\n  MenuItem\n} from \"@material-ui/core\";\nimport useDataOne from \"../useActions/useDataOne\";\nimport usePost from \"../useActions/usePost\";\nimport { useState, useEffect } from \"react\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {},\n  content: {\n    padding: \"64px 0px 0px\"\n  },\n  card: {\n    backgroundColor: \"rgb(240 240 240)\",\n    padding: \"20px\",\n    margin: \"0px 20px 20px\"\n  },\n  textField: {\n    margin: \"10px 10px 20px\"\n  },\n  actions: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    padding: \"0px 20px 5px\",\n    marginTop: \"15px\"\n  },\n  button: {\n    margin: \"5px\"\n  },\n  process: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  formControl: {\n    display: \"flex\",\n    flexDirection: \"row\"\n  },\n  select: {\n    marginLeft: \"10px\"\n  }\n}));\nconst Index = props => {\n  const classes = useStyles();\n  const route = useRouter();\n  const { data: post, loading, error } = useDataOne(\"posts\", route.query.code);\n  const [updatePost, setUpdatePost] = useState(post);\n  const { postSave, postDelete, posting } = usePost();\n\n  const [categoryData, setCategoryData] = useState([]);\n  const [selected, setSelected] = useState();\n\n  useEffect(() => {\n    let category = localStorage.getItem(\"category\");\n    let category_sel = localStorage.getItem(\"category_sel\");\n    if (category) {\n      category = JSON.parse(category);\n      setCategoryData(category);\n    }\n    if (category_sel) {\n      category_sel = JSON.parse(category_sel);\n      setSelected(category_sel);\n    }\n  }, []);\n  useEffect(() => {\n    setUpdatePost(post);\n  }, [post]);\n\n  const handleOnSave = () => {\n    postSave(\n      post.code,\n      {\n        title: updatePost.title,\n        context: updatePost.context\n      },\n      {\n        success: res => {\n          if (res.data && res.data.msg) {\n            alert(res.data.msg);\n          }\n        },\n        fail: err => {\n          if (err.response.data && err.response.data.msg) {\n            alert(err.response.data.msg);\n          }\n        }\n      }\n    );\n  };\n  const handleOnDelete = () => {\n    if (window.confirm(\"정말 이 포스트를 삭제하시겠습니까?\"))\n      postDelete(post.code, {\n        success: res => {\n          if (res.data && res.data.msg) {\n            alert(res.data.msg);\n            route.back();\n          }\n        },\n        fail: err => {\n          if (err.response.data && err.response.data.msg) {\n            alert(err.response.data.msg);\n          }\n        }\n      });\n  };\n  const handleOnPosting = () => {\n    posting(updatePost, {\n      success: sres => {\n        if (sres.data && sres.data.msg) {\n          alert(sres.data.msg);\n          route.back();\n        }\n      },\n      fail: err => {\n        if (err.response && err.response.data) alert(err.response.data.msg);\n        console.log(err);\n      }\n    });\n  };\n  const handleUpdataPost = key => e => {\n    setUpdatePost({ ...updatePost, [key]: e.target.value });\n  };\n  const handleChange = e => setSelected(e.target.value);\n\n  const handleKeyDown = e => {\n    if (e.key === \"Enter\") {\n      console.log(e.target.value);\n      const datas = [...categoryData, e.target.value];\n      localStorage.setItem(\"category\", JSON.stringify(datas));\n      setCategoryData(datas);\n    }\n  };\n\n  const MyPage = (\n    <div className={classes.root}>\n      <ActionMyBar homeEnable={false} title={post.code || \"포스트\"} />\n      <div className={classes.content}>\n        <div className={classes.actions}>\n          <FormControl variant=\"filled\" classes={{ root: classes.formControl }}>\n            <TextField label=\"카테고리\" onKeyDown={handleKeyDown} />\n            <Select\n              className={classes.select}\n              labelId=\"demo-simple-select-filled-label\"\n              id=\"demo-simple-select-filled\"\n              value={selected}\n              defaultValue={selected}\n              onChange={handleChange}\n            >\n              {categoryData.map((item, index) => {\n                return (\n                  <MenuItem key={item + \"-\" + index} value={item}>\n                    {item}\n                  </MenuItem>\n                );\n              })}\n            </Select>\n          </FormControl>\n          <span>\n            <Button\n              className={classes.button}\n              variant=\"contained\"\n              color=\"secondary\"\n              disabled={loading}\n              onClick={handleOnDelete}\n            >\n              삭제\n            </Button>\n            <Button\n              className={classes.button}\n              variant=\"contained\"\n              color=\"primary\"\n              disabled={loading}\n              onClick={handleOnSave}\n            >\n              저장\n            </Button>\n            <Button\n              className={classes.button}\n              variant=\"contained\"\n              color=\"default\"\n              disabled={loading}\n              onClick={handleOnPosting}\n            >\n              포스팅\n            </Button>\n          </span>\n        </div>\n\n        <Card className={classes.card}>\n          {loading ? (\n            <div className={classes.process}>\n              <CircularProgress />\n            </div>\n          ) : (\n            <FormControl fullWidth variant=\"outlined\">\n              <TextField\n                className={classes.textField}\n                multiline\n                fullWidth\n                label={\"제목\"}\n                onChange={handleUpdataPost(\"title\")}\n                defaultValue={post.title}\n              />\n              <TextField\n                className={classes.textField}\n                multiline\n                fullWidth\n                label={\"내용\"}\n                onChange={handleUpdataPost(\"context\")}\n                defaultValue={post.context}\n              />\n            </FormControl>\n          )}\n        </Card>\n        {error && <p>{error}</p>}\n      </div>\n    </div>\n  );\n\n  return <Layout cookies={props.cookies} content={MyPage} />;\n};\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}